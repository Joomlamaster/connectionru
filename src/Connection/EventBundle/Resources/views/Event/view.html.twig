{% extends 'ConnectionWebBundle:Frontend:layout.html.twig' %}

{% block theme %}view-event{% endblock %}
{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('bundles/connectionevent/css/event.css') }}" type="text/css" />
{% endblock %}

{% block breadcrumbs %}
    <div class="container breadcrumbs">
        <ul>
            <li><a href="{{ path('connection_homepage') }}">Main page</a></li>
            <li>Event</li>
            <li>New York Philharmonic</li>
        </ul>
    </div>
{% endblock breadcrumbs %}
{% block content %}
    <div class="row">
        <div class="col-xs-8">
            <div class="row">
                <div class="col-xs-10">
                    <h4>{{ event.title is defined ? event.title : "" }}</h4>
                    <div class="row">
                        <div class="col-xs-5">
                            {#<img class="event-image" src="/bundles/connectionweb/img/test-event-pic.png" alt=""/>#}
                            <img class="event-image img-rounded" width="190" src="{{ event.image.path is defined ? event.image.path : "" }}" alt=""/>
                            <strong>Share this event</strong>
                            <a href="#">
                                <div class="share"><div class="sprite sprite-facebook"></div>Share</div>
                            </a>
                            <a href="#">
                                <div class="share"><div class="sprite sprite-pinterest"></div>Share</div>
                            </a>
                            <a href="#">
                                <div class="share"><div class="sprite sprite-instagram"></div>Share</div>
                            </a>
                        </div>
                        <div class="col-xs-7 details">
                            <time>{{ event.eventDate is defined ? event.eventDate|date : "" }}</time>
                            {#<h5>New York Philharmonic</h5>#}
                            <address>
                                <strong>Venue</strong><br>
                                {{ event.country.name is defined ? event.country.name : "" }}<br>
                                {{ event.state.name is defined ? event.state.name : "" }}<br>
                                <em><a href="#">Info</a> and <a href="#">map</a></em>
                            </address>
                            <a class="return" href="{{ path('event') }}"><div class="sprite sprite-return-events"></div>Return to events</a>

                            <h6>Event Description:</h6>
                            <em>
                                {{ event.description is defined ? event.description : "" }}
                            </em>
                            {% if app.user.id is defined %}
                                <div class="controls">
                                    <div class="going">
                                        <input type="checkbox" data-action="subscribe" {{ event.hasParticipant(app.user) ? "checked" : "" }}/>I'm going
                                    </div>
                                    <div class="going">
                                        <input type="checkbox" data-action="interested" {{ event.hasInterested(app.user) ? "checked" : "" }}/>Interested
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sx-12">
                            <div class="block-title"><h4>Comments:</h4></div>
                            <div class="comments">
                                {% if event.comments is defined and event.comments is not empty %}
                                    {% for comment in event.comments %}
                                        <div class="comment" >
                                            <div class="author"><a href="#">{{ comment.author.username }} | {{ comment.createdAt|date }}</a></div>
                                            <div class="content">{{ comment.comment }}</div>
                                        </div>
                                    {% endfor %}
                                {% endif %}
                            </div>
                            {% if is_granted('ROLE_USER') %}
                                <div class="add-comment-form">
                                    {{ render(controller("ConnectionEventBundle:Comment:addCommentForm", {'id': event.id})) }}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    {#<div class="row">#}
                        {#<div class="col-sx-12">#}
                            {#<div class="block-title">1 people interested:</div>#}
                            {#<div class="people">#}
                                {#<div class="people">#}
                                    {#<div class="face">#}
                                        {#<p class="name">Mara stone</p>#}
                                    {#</div>#}
                                {#</div>#}
                            {#</div>#}
                        {#</div>#}
                    {#</div>#}
                </div>
                {% if owner is defined and owner is not empty %}
                    <div class="col-xs-2 author">
                        <div class="block-title">Posted:</div>
                        <div class="people clearfix">
                            <div class="face">
                                <p class="name"><a href="{{ path('view_profile', {'id': owner.profile.id}) }}">{{ owner.username }}</a></p>
                                <img width="82px" src="{{ owner.profile.avatar }}">
                            </div>
                        </div>
                        <div class="event-stats">
                            view<br/>
                            {{ event.viewed is defined ? event.viewed: "" }}<br/>
                            <br/>
                            comment<br/>
                            {{ event.countComments }}<br/>
                            <br/>
                            going<br/>
                            {{ event.countParticipants }}<br/>
                            <br/>
                            interested<br/>
                            {{ event.countInteresteds }}<br/>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="col-xs-4 upcoming">
            <div class="row">
                <div class="block-title">Related upcoming events:</div>
            </div>
            <div class="row">
                <div class="event-small">
                    <div class="col-xs-4">
                        <img src="/bundles/connectionweb/img/test-event-pic.png" alt=""/>
                    </div>
                    <div class="col-xs-8">
                        <time>15.06.2014</time>
                        <a class="title" href="#">OFFICE & Residential</a>
                        <em>(NYC) pic map</em><br/>
                        <a href="#" class="btn-gradient">View</a>
                        <br/>
                        <em>Posted:</em>
                        <a href="#" class="name">Joshua Bell</a>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="event-small">
                    <div class="col-xs-4">
                        <img src="/bundles/connectionweb/img/test-event-pic.png" alt=""/>
                    </div>
                    <div class="col-xs-8">
                        <time>15.06.2014</time>
                        <a class="title" href="#">OFFICE & Residential</a>
                        <em>(NYC) pic map</em><br/>
                        <a href="#" class="btn-gradient">View</a>
                        <br/>
                        <em>Posted:</em>
                        <a href="#" class="name">Joshua Bell</a>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="event-small">
                    <div class="col-xs-4">
                        <img src="/bundles/connectionweb/img/test-event-pic.png" alt=""/>
                    </div>
                    <div class="col-xs-8">
                        <time>15.06.2014</time>
                        <a class="title" href="#">OFFICE & Residential</a>
                        <em>(NYC) pic map</em><br/>
                        <a href="#" class="btn-gradient">View</a>
                        <br/>
                        <em>Posted:</em>
                        <a href="#" class="name">Joshua Bell</a>
                    </div>
                </div>
            </div>
            <div class="row">
                <a href="#">
                    <div class="more">View all / others</div>
                </a>
            </div>
        </div>
    </div>
{% endblock %}
{% block javascript %}
    {{ parent() }}
    <script type="text/javascript" src="{{ asset('bundles/connectionevent/js/event.js') }}"></script>
    <script type="text/javascript">
        $(function() {
            EM.subscriber.init(
                    "{{ path('event_subscribe', {id: event.id}) }}",
                    "{{ path('event_unsubscribe', {id: event.id}) }}",
                    "{{ path('event_interested', {id: event.id}) }}",
                    "{{ path('event_not_interested', {id: event.id}) }}"
            );
            EM.comment.init("{{ path('add_event_comment') }}");
        });
    </script>
{% endblock %}