{% extends 'ConnectionWebBundle:Frontend:layout.html.twig' %}
{% block theme %}view-profile{% endblock %}

{% block breadcrumbs %}
    <div class="container breadcrumbs">
        <ul>
            <li><a href="{{ path('connection_homepage') }}">Main page</a></li>
            <li>Profile</li>
        </ul>
    </div>
{% endblock breadcrumbs %}
{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('bundles/connectionuser/css/profile.css') }}" type="text/css" />
{% endblock %}

{% block content %}
    <h4>Account:</h4>
        <div class="row">
            <div class="col-xs-2">
                <div id="add-photo">
                    {% if user.profile.avatar is defined and user.profile.avatar is not empty %}
                        <img class="img-rounded" width="140" height="190" src="{{ user.profile.avatar }}">
                    {% else %}
                        <div class="msg">
                            <div class="sprite sprite-add-photo"></div>
                        </div>
                    {% endif %}
                </div>
                <div class="text-center">
                    <a href="{{ path('message_new', {id: user.id}) }}" class="btn btn-info">Message</a>
                </div>
                {% if app.user and app.user != user %}
                    {% if app.user.hasFavoriteUser(user) %}
                        <div>
                            <a href="{{path('favorite_user_remove',{'id':user.id} )}}" class="btn btn-xs btn-info" title="Remove user from favorites">
                                <span class="glyphicon glyphicon-remove-circle"></span>
                            </a>
                        </div>
                    {% else %}
                        <div>
                            <a href="{{path('favorite_user_add',{'id':user.id} )}}" class="btn btn-xs btn-info" title="Add user to favorites">
                                <span class="glyphicon glyphicon-star"></span>
                            </a>
                        </div>
                    {% endif %}
                {% endif %}
            </div>
            <div class="col-xs-10">
                <ul class="nav nav-tabs" id="profile-tabs">
                    <li class="active"><a href="#profile">Profile</a></li>
                    <li><a href="#gallery">Gallery</a></li>
                    {% if events is defined and events is not empty %}
                        <li><a href="#events">Events</a></li>
                    {% endif %}
                </ul>

                <div class="tab-content">
                    <div class="tab-pane active" id="profile">
                        <div class="col-xs-10">
                            {{ include('ConnectionUserBundle:Profile/Part/View:personal_info.html.twig') }}
                        </div>
                    </div>
                    {% if userPhotos is defined and userPhotos is not empty %}
                        <div class="tab-pane" id="gallery">
                            {{ include('ConnectionUserBundle:Profile/Part/View:gallery.html.twig', {userPhotos: userPhotos}) }}
                        </div>
                    {% endif %}
                    {% if events is defined and events is not empty %}
                        <div class="tab-pane" id="events">
                            {{ include('ConnectionUserBundle:Profile/Part/Edit:events.html.twig', {events: events}) }}
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="col-xs-5"></div>
        </div>
{% endblock %}
{% block popup %}
    {{ include('ConnectionUserBundle:Profile/Popup:view_profile_image_popup.html.twig') }}
{% endblock %}
{% block javascript %}
    {{ parent() }}
    <script type="text/javascript" src="{{ asset('bundles/connectionweb/js/popup/popup.js') }}"></script>
    <script type="text/javascript">
        {# PopUp Listener (Upload/View/Update) #}
        FM.popUp.listen("{{ path('update_profile_image') }}");
        {# Tabs #}
        $('#profile-tabs a').click(function (e) {
            e.preventDefault();
            $(this).tab('show');
        });
    </script>
{% endblock %}